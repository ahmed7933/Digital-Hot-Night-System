<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hot Night ğŸ”¥ | Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>

    <style>
        /* CSS RESET & FONTS */
        :root { --primary: #d4af37; --bg: #050505; }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); font-family: 'Cairo', sans-serif; color: white; height: 100vh; overflow: hidden; display: flex; justify-content: center; align-items: center; }

        /* LOGIN SCREEN STYLES */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, #1a0505 0%, #000 90%); z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .login-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(212,175,55,0.3); padding: 40px 30px; border-radius: 25px; width: 90%; max-width: 350px; text-align: center; }
        .login-input { width: 100%; background: rgba(0,0,0,0.5); border: 1px solid #333; padding: 15px; border-radius: 12px; color: #fff; margin-bottom: 15px; font-family: 'Cairo'; font-size: 1.1rem; text-align: center; }
        .login-input:focus { border-color: var(--primary); }
        .btn-gold { background: linear-gradient(90deg, #b8860b, #ffd700, #b8860b); color: black; font-weight: bold; padding: 12px; width: 100%; border-radius: 50px; border: none; font-size: 1.1rem; cursor: pointer; margin-top: 10px; }
        .btn-gold:disabled { opacity: 0.5; cursor: not-allowed; }
        .msg { margin-top: 15px; font-size: 0.9rem; min-height: 20px; }
        .msg-err { color: #ff4d4d; } .msg-ok { color: #2ecc71; }
        
        /* WELCOME & APP STYLES (Hidden Initially) */
        #welcome-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9998; justify-content: center; align-items: center; flex-direction: column; }
        #dashboard { display: none; width: 100%; height: 100%; text-align: center; padding-top: 50px; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-card">
            <div style="font-size:3rem; margin-bottom:10px;">ğŸ”¥</div>
            <h2 style="color:#d4af37; margin-bottom:5px;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <p style="color:#888; font-size:0.8rem; margin-bottom:20px;">Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ù‡Ø±Ø© Ø§Ù„Ø¢Ù…Ù†</p>
            
            <input type="text" id="username" class="login-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            <input type="tel" id="password" class="login-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (4 Ø£Ø±Ù‚Ø§Ù…)" maxlength="4">
            
            <button class="btn-gold" id="login-btn">Ø¯Ø®ÙˆÙ„</button>
            <div id="msg-box" class="msg"></div>
        </div>
    </div>

    <div id="welcome-overlay">
        <h1 style="color:#d4af37;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø¨Ø·Ù„! ğŸš€</h1>
        <p style="color:#fff;">ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø³Ù‡Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­</p>
        <button class="btn-gold" style="width: 200px;" onclick="alert('Ù‡Ù†Ø§ Ù‡ØªØ¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© (Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯)');">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
    </div>

    <script>
        // Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzb2DSj-DkCWXpOIEYx5K9YXjmTyEnKqisinT1WChncWIeEA9At8GVU95cNSO75pf7x/exec";

        // ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø²Ø±Ø§Ø± ÙÙˆØ± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            const btn = document.getElementById('login-btn');
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø« ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ù…Ù„
            btn.addEventListener('click', performLogin);
            
            console.log("System Ready...");
        };

        async function performLogin() {
            const user = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value.trim();
            const msg = document.getElementById('msg-box');
            const btn = document.getElementById('login-btn');

            msg.innerText = "";
            msg.className = "msg";

            if(!user || !pass) {
                msg.innerText = "â›” Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø§Ù„Ø£ÙˆÙ„";
                msg.classList.add("msg-err");
                return;
            }

            // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ù…ÙŠÙ„
            btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...";
            btn.disabled = true;

            try {
                // 1. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ØµÙ…Ø©
                let deviceId = "unknown";
                try {
                    const fp = await FingerprintJS.load();
                    const result = await fp.get();
                    deviceId = result.visitorId;
                } catch(e) {
                    console.log("Fingerprint Error (Skipped):", e);
                    deviceId = "dev_" + Math.random().toString(36).substring(7);
                }

                // 2. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const finalUrl = `${SCRIPT_URL}?action=login&username=${encodeURIComponent(user)}&password=${encodeURIComponent(pass)}&deviceId=${deviceId}`;
                
                const response = await fetch(finalUrl);
                const data = await response.json();

                // 3. ÙØ­Øµ Ø§Ù„Ø±Ø¯
                if (data.success) {
                    msg.innerText = data.message || "ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! âœ…";
                    msg.classList.add("msg-ok");
                    
                    // Ø§Ø®ØªÙØ§Ø¡ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¸Ù‡ÙˆØ± Ø§Ù„Ù„Ø¹Ø¨Ø©
                    setTimeout(() => {
                        document.getElementById('login-overlay').style.display = 'none';
                        document.getElementById('welcome-overlay').style.display = 'flex';
                    }, 1000);
                } else {
                    throw new Error(data.message);
                }

            } catch (error) {
                btn.innerText = "Ø¯Ø®ÙˆÙ„";
                btn.disabled = false;
                msg.innerText = "Ø®Ø·Ø£: " + error.message;
                msg.classList.add("msg-err");
            }
        }
    </script>

</body>
</html>
